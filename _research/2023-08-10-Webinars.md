---
title: "Docker-Packaged Webinars"
tags: docker R python teaching interactive webinar
article_header:
  type: overlay
  theme: dark
  background_image:
    gradient: 'linear-gradient(135deg, rgba(0, 0, 0 , .4), rgba(0, 0, 0, .4))'
    src: /media/saml/SAML_MLP.png
cover: /media/saml/metrics.png
---

<br>

As part of our work with the Melinda & Gates Foundation we've developed a coupkle of webinars for our software packages using Docker with other packaging tools to make it as easy as possible for our audience to get the materials up and running.

<br>

<!--more-->

Most of our software deliverables were developed to be used by researchers with diverse backgrounds. To improve the reach and accessibility of our toolkits we've developed some webinars built with Docker so that everyone can get the basics of running analysis in our frameworks.


# Why use Docker?

When we started thinking on putting together our webinar we realized the first hurdle for attendees was going to be to get the software running correctly with all its dependencies. In both cases, MGDrivE and MGSurvE, we provide installation instructions and as few dependencies as we can but it's inevitable that one of the three main operating systems (Linux, MacOS, or Windows) is going to have some problem eventually and this is where Docker comes in. In a nutshell, Docker allows us to create a "container" which will run an operating system along with all the things we need for our frameworks to run correctly. When attendees download and launch the container, they already have a working and running version of the whole set of materials. Moreover, as we are using Python and R, we make use of Jupyter and R-Studio so that our audience can simply head to a web-browser after launching the container, and start working right there and then.

```bash
# Downloading the container
docker pull chipdelmal/mgsurve_webinar2023
# Launching the materials
docker run -p 8888:8888 chipdelmal/mgsurve_webinar2023
```

In this post I go through some of the details of how the materials and code were setup.


# How is it done?




## Webinars' Contents

One of the advantages of working with Docker in combination with virtual environments and VSCode is that all the materials we need for our sessions could be generated locally in our personal computers in normal R files and Jupyter notebooks, and, when we were ready, we just bundled everything together and released to our DockerHub.


## Dockerfile

To get started with our docker images, we need to create a Dockerfile which acts as a recipe that will be run to generate our container.


### Rocker-RStudio (MGDrivE)

```docker
FROM rocker/rstudio
LABEL maintainer="Hector M. Sanchez C. <sanchez.hmsc@berkeley.edu>"
###############################################################################
# Setup Structure
###############################################################################
RUN mkdir /home/mgdrive \
    && mkdir /home/mgdrive/demos \
    && mkdir /home/mgdrive/sims_out
COPY README.md /home/mgdrive
COPY ./demos/ /home/mgdrive/demos
###############################################################################
# Install R Packages
###############################################################################
RUN R -e "install.packages('MGDrivE', dependencies=TRUE, repos='http://cran.rstudio.com/')" \
    && R -e "install.packages('MGDrivE2', dependencies=TRUE, repos='http://cran.rstudio.com/')" \
    && R -e "install.packages('rstudioapi', dependencies=TRUE, repos='http://cran.rstudio.com/')" 
###############################################################################
# Install Linux Packages
###############################################################################
RUN apt-get update \
    && apt-get install nano \
    && apt-get install -y --no-install-recommends libxt6 \
    && apt-get install htop
```

### Jupyterlab (MGSurvE)

```docker
FROM continuumio/miniconda3
LABEL maintainer="Hector M. Sanchez C. <sanchez.hmsc@berkeley.edu>"
###############################################################################
# Setup Structure
###############################################################################
RUN apt-get update \
    && apt-get install nano tini \
    && apt-get install gcc -y \
    && rm -rf /var/lib/apt/lists/* \
    && mkdir MGSurvE_Webinar2023
WORKDIR /MGSurvE_Webinar2023
RUN mkdir tests \
    && mkdir demos \
    && mkdir data \
    && mkdir media
###############################################################################
# Copy Files
###############################################################################
COPY ./demos/ ./demos/ 
COPY ./tests/ ./tests/
COPY ./data/ ./data/
COPY ./media/ ./media/
COPY LICENSE .
COPY README.md .
###############################################################################
# Install Packages
###############################################################################
RUN conda update -n base -c defaults conda \
    && conda config --set offline false \
    && conda config --add channels conda-forge \
    && conda config --add channels bioconda \
    && conda install gdal fiona pyproj cartopy libpysal -y \
    && conda install -c conda-forge deap nodejs osmnx -y \ 
    && conda install -c conda-forge jupyter jupyterlab basemap-data-hires -y \
    && python -m pip install termcolor MGSurvE 
###############################################################################
# Entrypoint
###############################################################################
EXPOSE 8888
CMD ["jupyter", "lab", "--ip='0.0.0.0'", "--port=8888", "--no-browser", "--allow-root", "--NotebookApp.token=''","--NotebookApp.password=''"]
```

## Makefile

```makefile
SHELL=/bin/bash
python='python'
pip=pip
version:=$(shell $(python) version.py)
JUPYTER=$(shell dirname $(shell which python))/jupyter

docker_build:
	- docker rmi mgsurve_webinar2023:dev -f
	- docker build -t mgsurve_webinar2023:dev .

docker_run:
	- docker run -p 8888:8888 mgsurve_webinar2023:dev

docker_release:
	- make docker_build
	- make jupyter_all
	- docker build -t chipdelmal/mgsurve_webinar2023:$(version) .
	- docker push chipdelmal/mgsurve_webinar2023:$(version)
	- docker build -t chipdelmal/mgsurve_webinar2023:latest .
	- docker push chipdelmal/mgsurve_webinar2023:latest
```


# Code Repos


* **MGSurvE:** Docker & [GitHub](https://github.com/Chipdelmal/MGSurvE_Webinar2023)
* **MGDrivE:** Docker & GitHub
