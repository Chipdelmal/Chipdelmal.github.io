---
title: "MGDrivE"
tags: crispr modelling mosquito spatial gene-drive tensors metapopulation
article_header:
  type: overlay
  theme: dark
  background_image:
    gradient: 'linear-gradient(135deg, rgba(0, 0, 0 , .4), rgba(0, 0, 0, .4))'
    src: /media/mgdrive/mgdrive_diagram.png
cover: /media/mgdrive/mgdrive_diagram.png
---


[MGDrivE (Mosquito Gene Drive Explorer)](https://marshalllab.github.io/MGDrivE/) is a mathematical model created to test and compare gene-drive constructs to reduce the spread of mosquito-borne diseases in complex spatial contexts.

<!--more-->

# Intro and Context

MGDrivE was my main project when I first arrived at UC, Berkeley. At that time, we were looking for a way to model different mosquito gene constructs in a more streamlined way because up to that point, most of the gene drive modeling was done by "hard-coding" a series of matrices equations taking into account the drive construct and its parameters. This is just a snippet of an example:

<center><img src="/media/mgdrive/old1.png" style="width: 50%;"><img src="/media/mgdrive/old3.png" style="width: 50%;"></center>

From which it can be seen that there is an underlying matrix structure that we wanted to figure out so that the gene drive component was generalizable.

Additionally, we wanted to extend the model to be able to take into account more than a handful of connected populations, as most papers up to that point dealt only with *ad hoc* regular landscapes.


# Modules

Coming from an engineering background, the first thing that came to mind was to separate the components to be able to analyze and process them independently. 

In the original equations we were extending (ADD REFERENCE), it became quite apparent to me that the mosquito life-cycle was getting mixed with the inheritance aspects of the reproduction; so the first task I wanted to take on was to de-couple these elements.

Regarding the spatial context, up to that point I had been working a lot on network theory for different projects, so it was somewhat natural to me to think of it as a network of interconnected mosquito populations in which they could move and mate.


This left us with 3 modules to develop:

<center><img src="/media/mgdrive/NCCBSlide3.png" style="width: 100%;"></center>



## Inheritance Cube

$$ 
  \begin{align*}
    \overline{O(T_x)} =
      & \sum_{j=1}^{n} \Bigg( \bigg( (\beta*\overline{s} * \overline{ \overline{Af_{[t-T_x]}}}) * \overline{\overline{\overline{Ih}}} \bigg) * \Lambda  \Bigg)^{\top}_{ij}\\
  \end{align*}
$$

## Meta-Populations

$$ 
  \begin{align*}
    \overline{Am_{(t)}^{i}}=
      &\sum{\overline{A_{m}^j} \otimes \overline{\overline{\tau m_{[t-1]}}}} \\
    \overline{\overline{Af_{(t)}^{i}}}=
      &\sum{\overline{\overline{A_{f}^j}} \otimes \overline{\overline{\tau f_{[t-1]}}}}
  \end{align*} 
$$

<center><img src="/media/mgdrive/01_Movement.jpg" style="width: 50%;"></center>


## Life History

$$ 
  \begin{align*}
    \overline{L_{[t]}}=
      &\overline{L_{[t-1]}} * (1-\mu_{l}) * F(\overline{L_{[t-1]})}
      +\overline{O(T_e)}* \theta_{e}
      - \overline{O(T_e+T_l)} * \theta_{e} * D(\theta_l,0)\\
    \overline{E^{'}}=& \overline{O(T_e+T_l+T_p)} * \bigg(\overline{\xi_m} * (\theta_{e} * \theta_{p}) * (1-\mu_{ad}) * D(\theta_l,T_p) \bigg)\\
    \overline{Am_{[t]}}=&
      \overline{Am_{[t-1]}} * (1-\mu_{ad})*\overline{\omega_m}
      + (1-\overline{\phi}) *  \overline{E^{'}}
      + \overline{\nu m_{[t-1]}}\\
    \overline{\overline{Af_{[t]}}}=&
      \overline{\overline{Af_{[t-1]}}} * (1-\mu_{ad}) * \overline{\omega_f}
      +  \bigg( \overline{\phi} * \overline{E^{'}}+\overline{\nu f_{[t-1]}}\bigg)^{\top} * \bigg( \frac{\overline{\eta}*\overline{Am_{[t-1]}}}{\sum{\overline{Am_{[t-1]}}}} \bigg)\\
  \end{align*} 
$$



# Availability

[R (CRAN indexed) package](https://cran.r-project.org/web/packages/MGDrivE/index.html)

# Publications

* Scientific Reports 2016 [Mathematical models of human mobility of relevance to malaria transmission in Africa](https://www.researchgate.net/publication/325171555_Mathematical_models_of_human_mobility_of_relevance_to_malaria_transmission_in_Africa)