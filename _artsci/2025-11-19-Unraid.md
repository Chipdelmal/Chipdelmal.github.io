---
title: "Unraid NAS"
tags: media nas ffmpeg docker network
article_header:
  type: overlay
  theme: dark
  background_image:
    gradient: 'linear-gradient(135deg, rgba(0, 0, 0 , .4), rgba(0, 0, 0, .4))'
    src: /media/unraid/banner.png
cover: /media/unraid/unraidSq.png
---

<!--more-->

# Intro

This post will be way more hardware-oriented than my usual but its been a project I had had in mind for a long while and finally got to put it together in the last six months or so. This is not meant to be a full setup guide but more of a compilation of process and sources to setup a similar solution.

After testing out [Jellyfin](https://jellyfin.org/) as described in my [previous post](./artsci/2024-08-14-Jellyfin.html) along with [Immich](https://immich.app/) to compile and consolidate the family photo collection, I wanted to setup a formal [network attached storage (NAS)](https://en.wikipedia.org/wiki/Network-attached_storage). Up to this point I had been playing around with _ad hoc_ setups that worked reasonably well but were a bit unreliable in the long run (updates were messy and there were frequent hiccups with the system), so I did some more research, saved some money, and went for a full dedicated NAS solution.

In terms of OS, I tried running both [TrueNAS](https://www.truenas.com/) and [Unraid](https://unraid.net) in a couple of [Virtualbox](https://www.virtualbox.org/) instances for a bit of time, as that path allowed me to instantiate virtual disks and setups to test how the setup process went in each one of the systems. [TrueNAS](https://www.truenas.com/) seemed quite robust and reliable, the setup required much more planning and _a priori_ knowledge on NAS systems as compared to [Unraid](https://unraid.net). After watching a bunch of videos and reading quite a bit, I went with the latter for my build, as it allowed for more flexibility in mixing up different-sized HDDs and the [community](https://forums.unraid.net/) seemed to be very focused on applications such as media streaming and libraries management through [Docker containers](https://docs.unraid.net/unraid-os/using-unraid-to/run-docker-containers/managing-and-customizing-containers/), and their [starter guides](https://unraid.net/getting-started?srsltid=AfmBOopee50U9lvwExBTpdTLMkmJs2LSzmg_rFUBKHj8v5qvPaOu5ajV) were quite friendly and easy to follow.

<center><img src="/media/unraid/unraidSq.png" style="width:100%;"></center>

<!--<center><a href='https://youtu.be/GIpf4DmJgcA?si=Jy0CsqDOwa7xoetG'><img src="/media/unraid/compare.jpg" style="width:30%;"></a></center>-->


# Hardware

I had initially thought of using my old laptop and to buy a [DAS](https://en.wikipedia.org/wiki/Direct-attached_storage) for storage but decided against it because I didn't want to rely on the USB connection between the two devices as this has caused me trouble in the past. This motivated me to save some money and buy a dedicated hardware solution for the project.

## NAS

I went with the [Terramaster F4-424 4-Bay](https://www.terra-master.com/en-us/collections/home-soho-nas/products/f4-424-nas) as I mainly wanted a setup to stream my music, tv/movies, and to store my photography collections. This build seemed like it would be a reasonable compromise between computational power and low electricity consumption with four bays for disk drives and two NVMe slots. Must confess that I was tempted by the PRO/MAX versions too, but decided to keep the cost a bit lower as to use that money in memory and a RAM expansion.

<center><img src="/media/unraid/f424.png" style="width:100%;"></center>

## Cache/Array

For cache I chose the [2TB WD_BLACK SN7100 NVMe SSD](https://shop.sandisk.com/products/ssd/internal-ssd/wd-black-sn7100-nvme-internal-ssd?sku=WDS500G4X0E-00CJA0). I really didn't need the 2TB but it was at a reasonable price as compared to the 1TB version, so I just went with it as it would also give me more flexibility and expandability in applications.

As for the main storage I got a couple of [Seagate IronWolf 8TB NAS](https://www.seagate.com/products/nas-drives/ironwolf-hard-drive/) on sale, and had a [Western Digital Ultrastar 10TB (He10/12)](https://www.westerndigital.com/support/hgst/data-center-drives/hdd/ultrastar-he10) laying around. These three disks would make up the main storage array and I had an additional [Ultrastar DC HC510 10TB](https://documents.westerndigital.com/content/dam/doc-library/en_us/assets/public/western-digital/product/data-center-drives/ultrastar-dc-hc500-series/data-sheet-ultrastar-dc-hc510.pdf), which was setup as parity.

Finally, after some research and following [NASCompares' guide](https://nascompares.com/guide/unraid-terramaster-nas-full-installation-guide-2025/), I got a [SanDisk 16GB Ultra Fit USB](https://shop.sandisk.com/products/usb-flash-drives/sandisk-ultra-fit-usb-3-1?sku=SDCZ430-016G-G46) to install and run the OS (as [unraid](https://unraid.net) loads from the flash drive into memory).

<center><img src="/media/unraid/hw1.png" style="width:50%;"></center>

## RAM

I did not expand the RAM right away, in my initial tests the server's performance was good enough for most applications but every now and then the system would stutter a bit, and usage was often above 80% so I decided to double the memory to 16Gb with the official [A-SRAMD5-16G](https://www.terra-master.com/products/a-sramd5-16g) to avoid compatibility issues.

<center><img src="/media/unraid/hw2.png" style="width:40%;"></center>

## Travel Router

One additional thing I wanted to try was to use the NAS as a VPN. For this to be as flexible as possible, and after watching [The Uncast Show's: "The Ultimate Guide to Tailscale on Unraid"](https://youtu.be/WkCqAuGhWb8?si=7kXMkxOpYP-c9FxO) I went ahead and got a [Beryl AX](https://www.gl-inet.com/products/gl-mt3000/) so that any device connected to it was redirected to the NAS' exit node.

<center><img src="/media/unraid/beryl.png" style="width:30%;"></center>


# Setup


## First Boot

Once I got the F-242 and checked that it booted with the [original OS](https://www.terra-master.com/en-us/pages/terramaster-os-tos). I went ahead and followed [NASCompares great guide](https://youtu.be/rs7jHH2XhKE?si=FWgzQNyfYk6mv3Fc) to setup my bootable flashdrive. [Unraid](https://unraid.net) is a bit unique in that the OS and configuration file are stored in a flash drive and loaded into memory at boot, so the USB memory has to be plugged in internally. After removing some screws, I got the flashdrive in place, and waited patiently for the first boot.

<center>
  <img src="/media/unraid/boot.png" style="width:39%;">
  <img src="/media/unraid/boot1.jpg" style="width:30%;">
</center>

## Array/Pool
 
With the initial boot behind me, and a static IP setup, it was time to setup the HDDs in the array. I had already done a thorough flash in my Linux computer to make sure they were in reasonable shape for the NAS. In the array I used the two [8TB IronWolf](https://www.seagate.com/products/nas-drives/ironwolf-hard-drive/) disk with the [10TB HGST Ultrastar](https://www.westerndigital.com/support/hgst/data-center-drives/hdd/ultrastar-he10) as parity (the [10TB WD Ultrastar](https://www.westerndigital.com/support/hgst/data-center-drives/hdd/ultrastar-he10) was added later after juggling around some data in a couple of other portable drives), and the [2TB WD_BLACK NVMe](https://shop.sandisk.com/products/ssd/internal-ssd/wd-black-sn7100-nvme-internal-ssd?sku=WDS500G4X0E-00CJA0) in the pool (cache). For the initial setup I followed [Elevated Systems' guide](https://youtu.be/huCE4jtXOjQ?si=ZYMO48ZQ3KxFaBM5) and after waiting for a bit, the array came online so I just waited for parity to get done before doing anything else. After parity was done I just did a full parity check followed by an extended SMART check on each one of the drives and it was all good to go to get started with the shares, and software installation.

<center><img src="/media/unraid/array.png" style="width:100%;"></center>

## Shares and Moving Data

I already had my music, movies, tv shows, and photo collections in a scattered group of HDDs, so I initially started transferring the files over the network. This wasn't too bad but it was a bit prone to disconnects. To make the process a bit faster and more reliable, I used my SanDisk [2TB Extreme Portable](https://shop.sandisk.com/products/ssd/external-ssd/portable-ssd-sandisk-extreme-usb-3-2?sku=SDSSDE61-500G-G25) with [Krusader](https://krusader.org/) to slowly and carefully move everything in the right naming and folder patterns (specially for [Jellyfin](https://jellyfin.org/docs/general/server/media/movies/), so that everything ran as smoothly as possible). The whole data-transferring process took a couple of weeks in total so, in the meantime I went ahead and started setting up the software in the NAS.

# Software Breakdown

This section is not meant to be a thorough installation guide but just a small breakdown of the docker applications I have found useful so far. I'm adding an Easy (E), Medium (M), Hard (H) qualitative score on how much general difficulty I had setting it up, and the tutorial or guide followed in the installation.

## Must Install

These set of applications are the ones that I'd say are an absolutely must to get running as they either make life easier, or enable more flexibility to run other docker images.

* [Krusader (E)](https://krusader.org/): a very lightweight file manager [[AlienTech42]](https://youtu.be/MkSYyZ66dq0?si=ytIcFqXomrj_um4b)
* [Tailscale (E)](https://tailscale.com/): enables easy remote access without needing to setup remote proxy [[The Uncast Show]](https://www.youtube.com/watch?v=WkCqAuGhWb8&t=1s)
* [Appdata Backup (E)](https://forums.unraid.net/topic/137710-plugin-appdatabackup/): runs scheduled backup for applications data [[AlienTech42]](https://youtu.be/ms4AnHgj9hc?si=5tgdcuPNS0ZWOn5s)
* [Docker Compose Manager](https://forums.unraid.net/topic/114415-plugin-docker-compose-manager/): provides a way to manage docker compose stacks
* [Unassigned Devices](https://github.com/dlandon/unassigned.devices): allows to mount unassigned devices (not part of an array)
* [Unassigned Devices Preclear](https://github.com/dlandon/unassigned.devices): allows to preclear unassigned devices (not part of an array)
* [Unbalanced](https://forums.unraid.net/topic/43651-plugin-unbalanced/): allows to move data between disks in an array for fine-scale management [[AlienTech42 guide]](https://youtu.be/1orfWpekkqw?si=DELQCYSNtOfPYnGo)

## Main Apps

As I eluded before, most of the intended use for my NAS was to store and stream my media collection and these are the apps that I have found the most useful.

* [Jellyfin (E)](https://jellyfin.org/): for movies/tv streaming and management [[BC Adventure]](https://youtu.be/3imxfsbwg7k?si=D1cpqsEWmhGpcig6)
* [Immich (M)](https://immich.app/): photo library management [[official guide]](https://docs.immich.app/install/unraid/)
* [Navidrome (E)](https://www.navidrome.org/): music streaming and management [[official guide]](https://www.navidrome.org/docs/installation/)
* [Audiobookshelf (E)](https://www.audiobookshelf.org/): audiobook/podcasts streaming and management [[AlienTech42]](https://youtu.be/JuC5jLdWt4c?si=dFU4XuDNTemQGgpD)
* [Calibre (M)](https://calibre-ebook.com/)/[Calibre-Web (M)](https://github.com/janeczku/calibre-web): book library management [[Technik22]](https://youtu.be/z7pTPr6EmPY?si=cOGPY3MYYYZ2E_n3)
* [RomM (H)](https://romm.app/): retrogames streamer and manager [[AlienTech42]](https://www.youtube.com/watch?v=ls5YcsFdwLQ&t=288s)
* [Vaultwarden (H)](https://github.com/dani-garcia/vaultwarden): password management [[The Uncast Show]](https://www.youtube.com/watch?v=2Go3gmgWxQI&t=1200s)


## Plugins/Auxiliary

* [MusicBrainz Picard (E)](https://picard.musicbrainz.org/): music metadata tagger
* [Jellemplex-Dedupe (E)](https://hub.docker.com/r/spaceinvaderone/jellemplex-dedupe): media de-duplicator [[The Uncast Show]](https://youtu.be/yG8UGG2Nx5A?si=HIoFlOebnSQwmvQr)
* [Handbrake (E)](https://handbrake.fr/): video encoder [[Spaceinvader One]](https://youtu.be/NA_sO3rH2mU?si=K2k2cchemrAU7dJ9)
* [Docker-WebUI](https://hub.docker.com/r/olprog/unraid-docker-webui): a simple frontend with links to all installed docker apps
* [Fix Common Problems](https://forums.unraid.net/topic/47266-plugin-ca-fix-common-problems/): scans system for common issues with configurations
* [Dynamix Cache Directories](https://forums.unraid.net/topic/34889-dynamix-v6-plugins/): caches filepaths so that disks don't have to spin when exploring folders
* [User Scripts](https://forums.unraid.net/topic/48286-plugin-ca-user-scripts/)/[User Scripts Enhanced](https://forums.unraid.net/topic/191294-plugin-user-scripts-enhanced/): allows the automation of custom scripts

<!--[FolderView2](https://forums.unraid.net/topic/189167-plugin-folderview2/):-->
<!--[DelugeVPN](https://github.com/binhex/arch-delugevpn):-->
<!--[MeTube](https://github.com/alexta69/metube)-->
<!--[SpotDL](https://spotdl.readthedocs.io/)-->


<center><img src="/media/unraid/docker.png" style="width:100%;"></center>

# Final Thoughts

This has been a pretty fun project and I've been learning quite a bit on data resilience, networks, disk hardware as well as extending knowledge on docker containers. Will try to post some updates in the future with new apps and upgrades as they come along.


# Sources

Whilst doing my research on [Unraid](https://unraid.net), I mostly followed the guides and videos from: [The Uncast Show](https://www.youtube.com/@uncastshow), [Spaceinvader One](https://www.youtube.com/c/SpaceinvaderOne), [AlienTech42](https://www.youtube.com/@AlienTech42), [BC Adventure](https://www.youtube.com/@bcadventure2015)